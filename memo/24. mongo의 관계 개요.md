# mongo와 데이터의 관계

- 데이터베이스에는 정말 다양한 엔티티가 존재하며 보통 여러 가지 방법을 통해 연결되어 있음
- 따라서 Mongo에서 다양한 관계를 모델링하는 방법과 어떤 패턴을 사용할 수 있는지 알고 있어야 함

# SQL 관계 개요

- SQL 데이터베이스는 모두 테이블에 정보를 조정하는 관계형 데이터베이스
- 테이블은 홀로 존재하며 매우 엄격한 스키마를 설정해야 하는 튼튼한 구조임
- 하지만 한 테이블에서 다른 테이블로 정보를 참조하거나 새 관계 테이블을 만들어서 관계를 모델링할 수 있음

- SQL이 늘 하는 일이 바로 이거임
- 한 테이블에서 정보를 얻고 다른 정보와 합침, 기본적으로 복사 붙여 넣기와 비슷
- 그리고 다양한 테이블에 있는 정보의 다양한 조각을 서로 깎고 붙여넣어서 생성되는 새로운 반응에 넣어줌

# One to Few 관계

- one to Many의 관계 중 하나
- 사용자가 두 가지나 그 이상의 여러가지 항목을 가질 때 이러한 관계를 저장할 가장 좋은 방법

```js
const userSchema = new mongoose.Schema({
  first: String,
  last: String,
  address: {
    street: String,
    city: String,
    state: String,
    country: String,
  },
});

const User = mongoose.model("User", userSchema);

const makeUser = async () => {
  const u = new User({
    first: "Harry",
    last: "Potter",
  });
  u.addresses.push({
    street: "123 Sesame St.",
    city: "New York",
    state: "NY",
    country: "USA",
  });
  const res = await u.save();
  console.log(res);
};

const addAddress = async (id) => {
  const user = await User.findById(id);
  user.addresses.push({
    street: "99 3rd St.",
    city: "New York",
    state: "NY",
    country: "USA",
  });
  const res = await user.save();
  console.log(res);
};
```
